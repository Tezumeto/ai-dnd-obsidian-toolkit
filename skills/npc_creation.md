# Skill: Создание NPC

## Когда использовать
- Пользователь просит создать персонажа (NPC)
- Упоминает роль, локацию или принадлежность NPC
- Требуется типовой или уникальный персонаж для сеттинга

---

## Контекст (что читать перед началом)

### Обязательно прочитать:

1. **Локация** — если NPC привязан к городу/региону:
   - Файл города: `!Лор/Мир/Атлас/**/*.md`
   - Файл организации/государства: `!Лор/Мир/Организации/**/*.md`

2. **Организация** — если NPC член организации:
   - `!Лор/Мир/Организации/**/*.md`

3. **Раса** — если NPC не человек:
   - `!Лор/Мир/Расы/**/*.md`

### Опционально:
- Связанные события: `!Лор/Мир/Хронология/**/*.md` (для исторического контекста)
- Другие NPC из той же локации (для консистентности)

---

## Методология

### 1. Уточняющие вопросы

Если информации недостаточно, спроси:
- В какой локации базируется NPC?
- Какая роль/профессия?
- Связь с организациями?
- Уникальный или типовой NPC?
- Нужно ли изображение?
- Какой уровень детализации? (краткий / полный)

### 2. Структура файла

**Используй Template:** `zUtilities/Templates/NPC Template.md`

**Эталон:** `!Черновик/Мэрта Хальг.md` — пример идеально оформленного NPC

**Ключевые требования к frontmatter:**
```yaml
---
type: NPC                    # Заглавными (NPC, не npc)
name: Полное имя
race: Раса
location:                    # Список из 4 уровней
  - "[[Город]]"
  - Королевство/Страна
  - Регион
  - Континент_1
organization:                # Опционально, если член организации
tags: [npc, роль, раса, локация]
created: YYYY-MM-DD
modified: YYYY-MM-DD
author: Tezu, агент         # Указывай соавторство
---
```

**Структура содержания (из Template):**
- `> [!changelog]-` — свёрнутый changelog
- `> [!infobox]` — компактная базовая информация
- **Описание** — внешность и первое впечатление (1-2 абзаца)
- **Характер** — с bold-цитатой ключевой черты
- **Запоминающиеся детали** — маркированный список
- **Манера речи** — маркированный список с примером
- **Товары и услуги** — таблица (если применимо)
- **Реплики** — 3 характерные цитаты
- **Сюжетные зацепки** — с bold заголовками
- **Промпт для изображения**

### 3. Wikilinks и метаданные

**Создай wikilinks на:**
- Локацию (город, регион) — в frontmatter и в тексте
- Организацию (если член) — в frontmatter и секции "Роль"
- Связанных NPC (союзники, враги, родственники) — в репликах и зацепках
- Расу (если в лоре есть детальное описание)

**Заполни frontmatter согласно эталону:**
- `type: NPC` — заглавными буквами (важно для Bases)
- `location:` — список из 4 уровней (город → страна → регион → континент)
- `tags: [npc, роль, раса, локация]` — строчными, для фильтрации в Bases
- `author: Tezu, агент` — всегда указывай соавторство с пользователем

### 4. Целевая папка

**Выбери папку в зависимости от значимости NPC:**

- `!Лор/НПЦ/Common/` — для **обычных NPC** (CR 0-4):
  - Стражники, торговцы, ремесленники
  - Массовые персонажи без уникальной истории
  - Могут быть переиспользованы в разных локациях
  - Минимальная детализация

- `!Лор/НПЦ/Uncommon/` — для **необычных NPC** (CR 5-10):
  - Значимые персонажи с запоминающимися чертами
  - Квестодатели, местные авторитеты
  - Связаны с конкретной локацией или организацией
  - Средняя детализация

- `!Лор/НПЦ/Legendary/` — для **легендарных NPC** (CR 11+):
  - Уникальные персонажи, боссы, важные фигуры
  - Ключевые для сюжета или истории мира
  - Детальная проработка истории и связей
  - Максимальная детализация

**Имя файла:** `Имя_Фамилия.md` или `Роль_Имя.md` (например: `Борг_Пепельный.md`, `Капитан_Марек.md`)

### 5. Консистентность

**Проверь на противоречия:**
- ✅ Соответствует ли NPC культуре локации?
- ✅ Логична ли его роль в организации?
- ✅ Нет ли конфликтов с установленным лором?
- ✅ Соответствует ли возраст историческим событиям? (текущий год: 1825 AR)
- ✅ Подходит ли NPC по тональности? (от dark fantasy до героики)

**Задавай вопросы:**
- "Почему этот персонаж здесь?"
- "Как он вписывается в локальную иерархию?"
- "Что делает его интересным для игроков?"

### 6. Changelog

**Добавь после frontmatter (свёрнутый callout):**
```markdown
> [!changelog]-
> **YYYY-MM-DD (агент):** Создан NPC. [Краткое описание причины создания]
```

**Формат:** Используй `-` после `[!changelog]` для автоматического сворачивания.

---

## Промпты для изображений

Если нужно изображение, используй skill `image_prompt.md` или следуй формату:

### Формат для NPC (портреты):
```
[Раса] [пол], [профессия/роль], [ключевая деталь одежды/экипировки], [эмоция/выражение], [окружение если важно]
--ar 9:16, dnd art, digital art
```

### Примеры:

**Стражник:**
```
Human male city guard, wearing blue tabard with silver anchor emblem, stern expression, holding spear, standing at harbor gate
--ar 9:16, dnd art, digital art
```

**Торговец:**
```
Dwarf male merchant, wearing rich velvet coat, friendly smile, behind counter with exotic goods, warm lighting
--ar 9:16, dnd art, digital art
```

**Мистический персонаж:**
```
Tiefling female fortune teller, wearing dark robes with golden embroidery, mysterious expression, surrounded by candles and tarot cards
--ar 9:16, dnd art, digital art
```

---

## Уровни детализации

### Краткий (для типовых NPC):
- Только основная информация
- 1 абзац описания
- 1-2 черты личности
- Минимум истории

### Полный (для уникальных NPC):
- Детальное описание всех секций
- Связи с другими NPC и организациями
- Роль в возможных квестах
- Секреты и скрытая информация
- Игромеханика (статблок или характеристики)

---

## Примеры по типам

### Обычный NPC (Common):

**Имя файла:** `Стражник_Эрик.md`
**Папка:** `!Лор/НПЦ/Common/`
**CR:** 0-4
**Детализация:** Краткая
**Использование:** Может появиться в любом городе как стражник

### Необычный NPC (Uncommon):

**Имя файла:** `Капитан_Марек_Железная_Рука.md`
**Папка:** `!Лор/НПЦ/Uncommon/`
**CR:** 5-10
**Детализация:** Средняя
**Использование:** Капитан стражи Сейры, связан с квестом

### Легендарный NPC (Legendary):

**Имя файл:** `Лорд_Валериан_Теневой_Клинок.md`
**Папка:** `!Лор/НПЦ/Legendary/`
**CR:** 11+
**Детализация:** Полная
**Использование:** Ключевая фигура политики, может быть антагонистом кампании

---

## Особенности сеттинга Val'trey

При создании NPC учитывай:
- **Смешение рас:** Особенно в портовых городах (Сейра)
- **Dark fantasy тон:** Персонажи могут быть морально неоднозначными
- **История мира:** Текущий год 1825 AR, события прошлого влияют на персонажей
- **Астральный Кит:** Редко упоминается напрямую, но может быть частью культов/мистических организаций

---

## Чеклист перед завершением

- [ ] Frontmatter заполнен корректно
- [ ] Wikilinks созданы для всех связей
- [ ] Локация соответствует лору
- [ ] Персонаж вписывается в тональность
- [ ] Добавлен changelog
- [ ] Файл сохранён в правильную папку
- [ ] Промпт для изображения создан (если нужно)

---

**Последнее обновление:** 2026-02-10 (v2)
**Автор skill:** claude
**Эталон:** `!Черновик/Мэрта Хальг.md`
**Template:** `zUtilities/Templates/NPC Template.md`
